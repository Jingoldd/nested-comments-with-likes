<h1><%= @post.title %></h1>

<p><%= @post.content %></p><br>

<!-- Like/Unlike button -->
  <p><%= @post.likes.count %> likes</p>
  
  <% if user_signed_in? %>
    <% like = current_user.likes.find_by(post: @post) %>
    
    <% if like.nil? %>
      <!-- button_to helper format -->
      <%= button_to "Like", likes_path, params: { post_id: @post.id } %>
      
      <!-- form_with format -->
      <%# <%= form_with url: likes_path do |form| %> 
      <%#  <%= form.hidden_field :post_id, value: "#{@post.id}" %>
      <%#  <%= form.submit "Like" %>
      <%# <% end %> 
    <% else %>
      
      <!-- button_to helper format -->
      <%= button_to "Unlike", like_path(like), method: :delete %>
      
      <!-- form_with format -->
      <%# <%= form_with model: like, method: :delete do |form| %> 
      <%#  <%= form.submit "Unlike" %>
      <%# <% end %>
    <% end %>
  <% end %>

<br>
<strong>Add a comment</strong>
<br>
<br>

<!-- 'Parent' Comments form -->
<%= render partial: 'comments/form', locals: { post: @post, parent: nil } %> <!-- parent comments has no parent -->
<br>

<% if user_signed_in? && @post.user_id === current_user[:id] %>
  <%= link_to 'Edit this post', edit_post_path(@post) %>
<% end %>
<br>
<br>

<%= link_to "Back Home", root_path %>
<br>
<br>
<h2>All Comments</h2>

<% if @post.comments.empty? %>
  No comments for this post yet
<% else %>
  <!-- Render only 'Parent' comments (parent_id: nil) -->
  <%= render @post.comments.where(parent_id: nil).includes(:user, :comments).order(id: :desc) %>
<% end %>
<br>




